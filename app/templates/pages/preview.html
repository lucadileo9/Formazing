{% extends "layout/base.html" %}

{% from "molecules/preview_training_info.html" import training_info_card %}
{% from "molecules/preview_telegram_messages.html" import telegram_messages_card %}
{% from "molecules/preview_email_section.html" import email_section_card %}
{% from "molecules/preview_action_form.html" import action_form %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<div class="container py-4">
    
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb bg-light rounded-3 p-3 shadow-sm">
            <li class="breadcrumb-item">
                <a href="{{ url_for('main.dashboard') }}" class="text-decoration-none">
                    <i class="bi bi-house-door me-1"></i>Dashboard
                </a>
            </li>
            <li class="breadcrumb-item active" aria-current="page">{{ action_title }}</li>
        </ol>
    </nav>

    <div class="row mb-4">
        <div class="col">
            <h1 class="display-5 fw-bold">{{ action_icon }} {{ action_title }}</h1>
            <p class="lead text-muted mb-0">Verifica i dettagli prima di procedere</p>
        </div>
    </div>

    {{ training_info_card(
        training=preview.training,
        action_type=action_type,
        codice_generato=preview.codice_generato if action_type == 'notification' else None
    ) }}

    {{ telegram_messages_card(messages=preview.messages) }}

    {% if action_type == 'notification' %}
        {{ email_section_card(email=preview.email) }}
    {% endif %}

    {{ action_form(
        action_type=action_type,
        training_id=training_id,
        codice_generato=preview.codice_generato if action_type == 'notification' else None,
        messages_count=preview.messages|length
    ) }}

</div>
{% endblock %}

{% block extra_css %}
<style>
    .card {
        transition: transform 0.2s ease-in-out;
    }
    
    .card:hover {
        transform: translateY(-2px);
    }
    
    code.user-select-all {
        user-select: all;
        cursor: pointer;
    }
</style>
{% endblock %}
